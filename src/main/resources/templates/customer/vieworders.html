<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Xem danh sách đơn hàng</title>
    <!-- Đường dẫn tới các tệp CSS của Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <style>
		
		body { background-color: #f8f9fa  }
		
    	h3 {
        	text-align: center;
        	margin-top: 3px;
        	margin-bottom: 20px;  
        	color: rgb(2,88,155);     	
    	}
    	
    	.table {
		    border-radius: 15px; /* Điều chỉnh giá trị này để thay đổi độ cong của góc */
		}
		.container-body {
        	padding: 20px;
        	margin-top: 40px;
        	margin-bottom: 40px;
        	border-radius: 15px;
        	background-color: white;
		}

	    .navbar-nav {
			display: frex;
		}
		.navbar-nav-left {
			width: 70%;
		}
		.navbar-nav-right {
			width: 30%;
		}
		.nav-link {
			display: flex;
      		align-items: center;
      		column-gap: 0.5rem;
      		width: fit-content;
		}
		.move-right {
			margin-left: auto;
			display: flex;
			float: right;
		}

		
		.container-body {
			box-shadow: 0 8px 10px rgb(226, 226, 226);
		}

		.material-symbols-outlined.info{
			color: grey;
		}

		.material-symbols-outlined.info:hover {
		 	color: rgb(2,88,155);
		}

		.material-symbols-outlined.search{
			color: rgb(2,88,155);
		}

		.badge {
			border-radius: 50px;
			display: flex;
			align-items: center;
			justify-content: center;
			height: 25px;
			width: auto;
		}

		.frame-number {
			display: flex;
    		justify-content: center;
			border-radius: 20px
		}

		.page-link {
            height: 40px;
            color: rgb(2,88,155);
            border: #f8f9fa;
            border-radius: 10px !important;
            margin: 2px;
        }
        .page-item.active .page-link {
            background-color: rgb(182,232,241);;
            color: rgb(2,88,155);
        }

        .page-link:hover {
            background-color: rgb(182,232,241);
        }

		.alert-success {
			color: rgb(91,181,111);
		}
		.alert-danger {
			color: rgb(247,80,80);
		}
	</style>
</head>
<body>
	<div th:replace="~{layout/header :: header}"></div>
	<!-- Hiển thị thông báo nếu có -->
	<div th:if="${param.message}" class="alert"
		 th:classappend="${#strings.containsIgnoreCase(param.message, 'thành công') ? 'alert-success' : 'alert-danger'}">
		<span th:text="${param.message}" style="font-weight: bold;justify-content: center; display: flex"></span>
	</div>

	<!--Nếu không có đơn hàng nào thì chuyển về trang này-->
	<div class="container"  th:if="${orders.isEmpty()}" style="padding: 0px">
		<div class="container-body" style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 0px; height: 350px">
			<img src="https://res.cloudinary.com/dylwewmt0/image/upload/v1713847596/order/order-empty.png" alt="" style="width: 180px;">
			<div class="row d-flex align-items-center justify-content-center">
				<p style="margin: 0px; color: grey; font-weight: bold; padding-bottom: 30px">Chưa có đơn hàng</p>
			</div>
		</div>
	</div>

    <div class="container" th:if="${!orders.isEmpty()}" style="padding: 0px">
		<div class="container-body" style="padding: 0px">
			<div class="col-00">
				<h6 style="color: #211f7f; align-items: center;  margin: 0px 5px 0px 0px; padding: 20px 0px 0px 20px; font-family: Verdana; font-weight: bold">Đơn hàng của tôi</h6>
				<div class="next-table only-bottom-border" style="margin-top: 20px">
					<div class="next-table-inner">
						<div class="next-table-header" style="height: 50px; border-top: 1px solid #cecece; background-color: #f2f5f6">
							<div class="next-table-header-inner">
								<table>
									<colgroup style="width: 1020px;">
										<col style="width: 15%;">
										<col style="width: 15%;">
										<col style="width: 15%;">
										<col style="width: 15%;">
										<col style="width: 15%;">
										<col style="width: 15%;">
										<col style="width: 10%;">
									</colgroup>
									<tbody>
									<tr>
										<th rowspan="1" class="next-table-header-node first" style="padding: 10px 20px;">
											<div class="next-table-cell-wrapper">Đơn hàng số</div>
										</th>
										<th rowspan="1" class="next-table-header-node " style="padding: 10px 20px; text-align: center;">
											<div class="next-table-cell-wrapper">Ngày đặt hàng</div>
										</th>
										<th rowspan="1" class="next-table-header-node " style="padding: 10px 20px; text-align: center">
											<div class="next-table-cell-wrapper">Sản phẩm</div>
										</th>
										<th rowspan="1" class="next-table-header-node " style="padding: 10px 20px; text-align: center">
											<div class="next-table-cell-wrapper">Trạng thái</div>
										</th>
										<th rowspan="1" class="next-table-header-node " style="padding: 10px 20px; text-align: center">
											<div class="next-table-cell-wrapper">Thanh toán</div>
										</th>
										<th rowspan="1" class="next-table-header-node " style="text-align: right; padding: 10px 20px;">
											<div class="next-table-cell-wrapper">Tổng tiền</div>
										</th>
										<th rowspan="1" class="next-table-header-node last" style="padding: 10px 20px;">
											<div class="next-table-cell-wrapper"></div>
										</th>
									</tr>
									</tbody>
								</table>
							</div>
						</div>

						<div class="next-table-body">
							<table>
								<colgroup style="width: 1020px;">
									<col style="width: 15%;">
									<col style="width: 15%;">
									<col style="width: 15%;">
									<col style="width: 15%;">
									<col style="width: 15%;">
									<col style="width: 15%;">
									<col style="width: 10%;">
								</colgroup>
								<tbody>
								<tr th:each="order : ${orders.content}" style="border-top: 1px solid #cecece; height: 150px" onmouseover="this.style.backgroundColor='#f2f5f6';" onmouseout="this.style.backgroundColor='transparent';">
									<td rowspan="1" class="next-table-header-node first" th:text="${order.id}" style="padding: 10px 20px;"></td>
									<td rowspan="1" class="next-table-header-node " th:text="${#temporals.format(order.dateOrder.toLocalDateTime(), 'dd/MM/yyyy')}" style="padding: 10px 20px; text-align: center"></td>
									<td rowspan="1" class="next-table-header-node " style="padding: 10px 20px; text-align: center;">
										<img th:src="${order.orderitems[0].book.bookImages[0].path}" width="70px" style="display: block; margin: auto;">
									</td>
									<td rowspan="1" class="next-table-header-node " style="padding: 10px 20px;">
										<span th:switch="${order.status}">
											<span th:case="0" class="badge badge-success">Chờ xác nhận</span>
											<span th:case="1" class="badge badge-info">Chờ lấy hàng</span>
											<span th:case="2" class="badge badge-primary">Đang giao</span>
											<span th:case="3" class="badge badge-success">Đã giao</span>
											<span th:case="4" class="badge badge-secondary">Đã hủy đơn</span>
											<span th:case="5" class="badge badge-warning">Yêu cầu trả hàng</span>
											<span th:case="6" class="badge badge-warning">Xử lý trả hàng</span>
											<span th:case="7" class="badge badge-success">Trả hàng thành công</span>
											<span th:case="8" class="badge badge-danger">Yêu cầu trả hàng bị từ chối</span>
											<span th:case="9" class="badge badge-danger">Không nhận hàng</span>
											<span th:case="10" class="badge badge-success">Đã nhận hàng</span>
											<span th:case="*" >Trạng thái không hợp lệ</span>
										</span>
									</td>
									<td rowspan="1" class="next-table-header-node " style="padding: 10px 20px;">
										<span th:switch="${order.paymentStatus.status}">
											<span th:case="0" class="badge badge-primary">Chưa thanh toán</span>
											<span th:case="1" class="badge badge-success">Đã thanh toán</span>
											<span th:case="2" class="badge badge-warning">Xử lý hoàn tiền</span>
											<span th:case="3" class="badge badge-success">Đã hoàn tiền</span>
											<span th:case="4" class="badge badge-success">Không cần thanh toán</span>
											<span th:case="5" class="badge badge-warning">Chờ thanh toán lại</span>
										</span>
									</td>

									<td rowspan="1" class="next-table-header-node " style="text-align: right; padding: 10px 20px; color: orangered; font-weight: bold;" th:text="${#numbers.formatInteger(order.totalPrice, 0, 'POINT') + ' đ'}"></td>
									<td rowspan="1" class="next-table-header-node last" style="padding: 10px 20px;">
										<a th:href="@{/vieworderitems(orderId=${order.id})}" class="detail" style="text-decoration: none; ">
											<span class="material-symbols-outlined info d-flex align-items-center justify-content-center">info</span>
										</a>
									</td>
								</tr>
								</tbody>
							</table>

							<!-- Thêm phần tử phân trang tại đây -->
							<div class="frame-number">
								<div th:if="${orders.totalPages > 1}">
									<ul class="pagination">
										<li th:if="${orders.hasPrevious()}" class="page-item">
											<a class="page-link" th:href="@{/vieworders(page=${orders.number}, size=${size}, sort=${sortOption}, orderId=${orderId}, accountId=${accountId})}">
												<span class="material-symbols-outlined">navigate_before</span>
											</a>
										</li>

										<th:block th:each="pageNumber : ${#numbers.sequence(0, orders.totalPages - 1)}">
											<li class="page-item" th:classappend="${pageNumber == orders.number ? 'active' : ''}">
												<th:block th:if="${pageNumber == orders.number}">
													<span class="page-link" th:text="${pageNumber + 1}"></span>
												</th:block>
												<th:block th:unless="${pageNumber == orders.number}">
													<a class="page-link" th:inline="text" th:href="@{/vieworders(page=${pageNumber + 1}, size=${size}, sort=${sortOption}, orderId=${orderId}, accountId=${accountId})}" th:text="${pageNumber + 1}"></a>
												</th:block>
											</li>
										</th:block>

										<li th:if="${orders.hasNext()}" class="page-item">
											<a class="page-link" th:href="@{/vieworders(page=${orders.number + 2}, size=${size}, sort=${sortOption}, orderId=${orderId}, accountId=${accountId})}">
												<span class="material-symbols-outlined">navigate_next</span>
											</a>
										</li>
									</ul>
								</div>
							</div>


						</div>
					</div>
				</div>
			</div>
		</div>

    </div>
    <!-- Đường dẫn tới các tệp JavaScript của Bootstrap -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <div th:replace="~{layout/footer :: footer}"></div>
</body>
</html>