<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Thông tin cá nhân</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">

	<!--Thêm đoạn javascript bên dưới để có thể thực hiện dropdown Account	?\\-->
	<!-- jQuery library -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

	<!-- Popper JS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

	<!-- Latest compiled JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


	<style>
		
		body { background-color: #f8f9fa  }

		.material-symbols-outlined.search{
			color: rgb(2,88,155);
		}


		.container-body {
        	margin-top: 40px;
        	margin-bottom: 40px;
        	border-radius: 15px;
        	padding: 20px;
        	align-items: center;
        	justify-content: center;
        	margin-left: 60px;
        	margin-right: 60px;
        	background-color: white;
		}
    	.content {
			color:  #211f7f;
			border: none;
			font-weight: 500;
		}
		.content:hover {
			color:  #211f7f;
		}

		.form-control {
			border-radius: 50px;
		}

		.form-control-name-user {
			width: auto;
		}

		.btn-edit-password {
			background-color: white;
			border-radius: 50px;
			color: #c90e0f;
			width: 200px;
			font-weight: bold;
			border: 1px solid #c90e0f;
		}
		.btn-add-password {
			margin-top: 20px;
			background-color: white;
			border-radius: 50px;
			color: #228b22;
			width: 200px;
			font-weight: bold;
			border: 1px solid #228b22;
		}
		.btn-edit-password:hover {
			background-color: #c90e0f;
			color: white;
			box-shadow: 0px 6px 8px rgba(0, 0.4, 0, 0.2);
			font-weight: bold;
		}
		.btn-add-password:hover {
			margin-top: 20px;
			background-color: #228b22;
			color: white;
			box-shadow: 0px 6px 8px rgba(0, 0.4, 0, 0.2);
			font-weight: bold;
		}


		#currentImage {
	        display: block;
	        margin-left: auto;
	        margin-right: auto;
    	}
    	.form-group {
			font-weight: 500;
		}
		
		.navbar-nav {
			display: frex;
		}
		.navbar-nav-left {
			width: 70%;
		}
		.navbar-nav-right {
			width: 30%;
		}
		.nav-link {
			display: flex;
      		align-items: center;
      		column-gap: 0.5rem;
      		width: fit-content;
		}
		.move-right {
			margin-left: auto;
			display: flex;
			float: right;
		}

		.container-body {
			box-shadow: 0 8px 10px rgb(226, 226, 226);
			
		}
		.container {
		 	padding: 0px 0px;
		 	align-items: center;
        	justify-content: center;
		}
		.col-02 {
			margin-left: 10px;
			margin-right: 10px;
		}

		col-03 {
			margin-left: 10px;
			margin-right: 10px;

		}
		.detail {
			border-radius: 10px;
			color: white;
			display: center;
			display: flex;
		    justify-content: center;
		    align-items: center;
		}

		.center-content {
			display: flex;
			justify-content: center;
			flex-direction: column;
		}

		.row-icon {
			align-items: center;
			justify-content: center;
			margin-bottom: 15px;
			width: 250px;
			display: flex;
			border: 1px solid #cecece;
			border-radius: 50px;
		}

		.material-symbols-outlined.info{
			color: grey;
		}

		.material-symbols-outlined.info:hover {
			color: rgb(2,88,155);
		}

		.frame-number {
			display: flex;
    		justify-content: center;
			border-radius: 20px
		}

		.page-link {
            height: 40px;
            color: rgb(2,88,155);
            border: #f8f9fa;
            border-radius: 10px !important;
            margin: 2px;
        }
        .page-item.active .page-link {
            background-color: #e0f3ff;
            color: rgb(2,88,155);
        }

        .page-link:hover {
            background-color: #e0f3ff;
        }

		.alert-success {
			color: rgb(91,181,111);
		}
		.alert-danger {
			color: rgb(247,80,80);
		}

		.btn-address.change-address-btn {
			margin-top: 20px;
			background-color: #36aa00;
			border-radius: 50px;
			color: white;
			width: 200px;
			box-shadow: 0px 4px 6px rgba(0, 0.4, 0, 0.2);
			font-weight: bold;
		}

		.btn-address.change-address-btn:hover {
			margin-top: 20px;
			background-color: #228b22;
			color: white;
			box-shadow: 0px 6px 8px rgba(0, 0.4, 0, 0.2);
			font-weight: bold;
		}
	</style>
</head>
<body>
	<div th:replace="~{layout/header :: header}"></div>

	<!-- Hiển thị thông báo nếu có -->
	<div id="myAlert" th:if="${param.message}" class="alert"
		 th:classappend="${#strings.containsIgnoreCase(param.message, 'thành công') ? 'alert-success' : 'alert-danger'}">
		<span th:text="${param.message}" style="font-weight: bold;justify-content: center; display: flex"></span>
	</div>
	<!--Nếu không có đơn hàng nào thì không hiển thị-->
	<div th:if="${orders.isEmpty()}"> </div>

    <div class="container">
        <div class="container-body" style="background-color: white;">
			<div class="row-00 d-flex align-items-center" style="height: 30px; margin-bottom: 20px">
				<div class="col-00" style="border-right: 2px solid #cecece;">
					<h6 style="color: #211f7f; align-items: center;  margin: 0px 5px 0px 0px; font-family: Verdana; font-weight: bold">Thông tin cá nhân</h6>
				</div>
				<div class="text-center" style="align-items: center">
					<a th:href="@{/updateaccount}" class="content" style="text-decoration: none; color: #5cbcd5; display: flex; align-items: center ">
						<span class="material-symbols-outlined" style="margin: 0px 5px; font-size: 1.2em;">ink_highlighter</span>
						<h6 style="margin: 0px">Chỉnh sửa</h6>
					</a>
				</div>
			</div>

			<div class="row" style="width: 980px; margin: 0px 0px; border-bottom: 1px solid #cecece">
				<div class="col-01 center-content align-items-center justify-content-center" style="width: 310px">
					<div class="form-group">
						<div th:if="${session.account != null and session.account.img != ''}">
							<img th:src="${session.account.img + '?v=' + randomNumber}" class="img-thumbnail" id="currentImage" alt="Hình ảnh hiện tại" style="width: 200px; height: 200px;">
						</div>
						<div th:if="${session.account == null or session.account.img == ''}">
							<img src="https://res.cloudinary.com/dosdzo1lg/image/upload/v1709875316/WebBookStoreKLTN/img_account/account_default.jpg" class="img-thumbnail" style="width: 200px; height: 200px;" id="currentImage2" alt="Hình ảnh mặc định">
						</div>
					</div>
					<div class="form-group" style="display: flex; align-items: center; margin: 0px; justify-content: center; height: 25px">
						<div class="row-01" style="display: flex;">
							<output class="form-control-name-user" id="firstName" name="firstName" th:text="${account.firstName}"
									style="display: flex; justify-content: flex-end; border: none; padding: 0px 0px; margin-right: 5px; font-weight: 500; height: 25px; color: rgb(2,88,155);"></output>
							<output class="form-control-name-user" id="lastName" name="lastName" th:text="${account.lastName}"
									style="border: none; padding: 0px 0px; font-weight: 500; height: 25px; color: rgb(2,88,155); width: auto"></output>
						</div>
					</div>

					<div class="form-group" style="display: flex; align-items: center; margin: 0px; justify-content: center">
						<div class="row-01" style="display: flex;">
							<output class="form-control" id="username" name="username" th:text="${account.username}" style="border: none; padding: 0px 0px; font-size: 12px"></output>
						</div>
					</div>
				</div>
				<div class="col-02 justify-content-center">
					<div class="row-02" style="display: flex">
						<div class="col-03 align-items-center justify-content-center" style="width: 330px">
							<div class="form-group" style="margin: 0px">
								<label for="email">Email:</label>
								<div class="row-icon" style="width: 315px">
									<span class="material-symbols-outlined" style="color: grey; margin-left: 8px;">mail</span>
									<output class="form-control" id="email" name="email" th:text="${account.email}" style="border-radius: 50px; border: none;" ></output>
								</div>
							</div>
							<div class="form-group">
								<label for="dob">Ngày sinh:</label>
								<div class="row-icon" style="width: 315px">
									<span class="material-symbols-outlined" style="color: grey; margin-left: 8px;">calendar_month</span>
									<output class="form-control" id="dob" name="dob" th:text="${#dates.format(account.dateOfBirth, 'dd/MM/yyyy')}" style="border-radius: 50px; border: none;"></output>
								</div>
							</div>
						</div>
						<div class="col-04 align-items-center justify-content-center" style="width: 320px">
							<div class="form-group" style="margin: 0px">
								<label for="phoneNumber">Số điện thoại:</label>
								<div class="row-icon" style="width: 315px">
									<span class="material-symbols-outlined" style="color: grey; margin-left: 8px;">call</span>
									<output class="form-control" id="phoneNumber" name="phoneNumber" th:text="${account.phoneNumber}" style="border-radius: 50px; border: none;"></output>
								</div>
							</div>
							<div class="form-group">
								<label for="gender">Giới tính:</label>
								<div class="row-icon" style="width: 315px">
									<span id="female-icon" class="material-symbols-outlined" style="color: grey; margin-left: 8px;">female</span>
									<span id="male-icon" class="material-symbols-outlined" style="color: grey; margin-left: 8px;">male</span>
									<output class="form-control" id="gender" name="gender" th:text="${account.gender}" style="border-radius: 50px; border: none;"></output>
								</div>
							</div>
						</div>
					</div>
					<div class="form-group" style="display: flex">
<!--						<label>Mật khẩu:</label>-->
						<div th:if="${account.password == 'logingoogle'}">
							<a th:href="@{/addpassword}" class="btn btn-add-password" style="width: 200px; ">Thêm mật khẩu</a>
						</div>
						<div th:if="${account.password != 'logingoogle'}">
							<a th:href="@{/changepassword}" class="btn btn-edit-password" style="width: 200px; margin-top: 15px">Đổi mật khẩu</a>
						</div>
					</div>
				</div>
			</div>

	        <div class="form-group" style="margin-top: 15px">
	            <label for="address">Địa chỉ mặc định:</label>
				<div class="row-icon" style="width: 980px;">
					<span class="material-symbols-outlined" style="color: grey; margin-left: 12px;">location_on</span>
					<output class="form-control" id="address" name="address" th:text="${account.address}" style="border-radius: 50px; border: none;"></output>
				</div>
	        </div>
			<div class="form-group d-flex align-items-center justify-content-center">
				<!-- Danh sách địa chỉ -->
				<div class="row-address">
					<a th:href="@{/viewaddresses}" class="btn btn-address change-address-btn">Danh sách địa chỉ</a>
				</div>
			</div>
        </div>

		<div class="container-body" style="padding: 0px" th:if="${!orders.isEmpty()}">
			<div class="col-00">
				<h6 style="color: #211f7f; align-items: center;  margin: 0px 5px 0px 0px; padding: 20px 0px 0px 20px; font-family: Verdana; font-weight: bold">Đơn hàng gần đây</h6>
				<div class="next-table only-bottom-border" style="margin-top: 20px">
					<div class="next-table-inner">
						<div class="next-table-header" style="height: 50px; border-top: 1px solid #cecece; background-color: #f2f5f6">
							<div class="next-table-header-inner">
								<table>
									<colgroup style="width: 1020px;">
										<col style="width: 20%;">
										<col style="width: 20%;">
										<col style="width: 30%;">
										<col style="width: 20%;">
										<col style="width: 10%;">
									</colgroup>
									<tbody>
										<tr>
											<th rowspan="1" class="next-table-header-node first" style="padding: 10px 20px;">
												<div class="next-table-cell-wrapper">Đơn hàng số</div>
											</th>
											<th rowspan="1" class="next-table-header-node " style="padding: 10px 20px; text-align: center">
												<div class="next-table-cell-wrapper">Ngày đặt hàng</div>
											</th>
											<th rowspan="1" class="next-table-header-node " style="padding: 10px 20px; text-align: center">
												<div class="next-table-cell-wrapper">Sản phẩm</div>
											</th>
											<th rowspan="1" class="next-table-header-node " style="text-align: right; padding: 10px 20px;">
												<div class="next-table-cell-wrapper">Tổng tiền</div>
											</th>
											<th rowspan="1" class="next-table-header-node last" style="padding: 10px 20px;">
												<div class="next-table-cell-wrapper"></div>
											</th>
										</tr>
									</tbody>
								</table>
							</div>
						</div>

						<div class="next-table-body">
							<table>
								<colgroup style="width: 1020px;">
									<col style="width: 20%;">
									<col style="width: 20%;">
									<col style="width: 30%;">
									<col style="width: 20%;">
									<col style="width: 10%;">
								</colgroup>
								<tbody>
									<tr th:each="order : ${orders.content}" style="border-top: 1px solid #cecece; height: 115px" onmouseover="this.style.backgroundColor='#f2f5f6';" onmouseout="this.style.backgroundColor='transparent';">
										<td rowspan="1" class="next-table-header-node first" th:text="${order.id}" style="padding: 10px 20px;"></td>
										<td rowspan="1" class="next-table-header-node " th:text="${#temporals.format(order.dateOrder.toLocalDateTime(), 'dd/MM/yyyy')}" style="padding: 10px 20px; text-align: center"></td>
										<td rowspan="1" class="next-table-header-node " style="padding: 10px 20px; text-align: center">
											<img th:src="${order.orderitems[0].book.bookImages[0].path}" width="60px">
										</td>
										<td rowspan="1" class="next-table-header-node " style="text-align: right; padding: 10px 20px; color: orangered; font-weight: bold;" th:text="${#numbers.formatInteger(order.totalPrice, 0, 'POINT') + ' đ'}"></td>
										<td rowspan="1" class="next-table-header-node last" style="padding: 10px 20px;">
											<a th:href="@{/vieworderitems(orderId=${order.id})}" class="detail" style="text-decoration: none; ">
												<span class="material-symbols-outlined info">arrow_forward_ios</span>
											</a>
										</td>
									</tr>
								</tbody>
							</table>

							<!-- Thêm phần tử phân trang tại đây -->
							<div class="frame-number">
								<div th:if="${orders.totalPages > 1}">
									<ul class="pagination">
										<li th:if="${orders.hasPrevious()}" class="page-item">
											<a class="page-link" th:href="@{/viewaccount(page=${orders.number}, size=${size}, sort=${sortOption}, orderId=${orderId}, accountId=${accountId})}">
												<span class="material-symbols-outlined">navigate_before</span>
											</a>
										</li>

										<th:block th:each="pageNumber : ${#numbers.sequence(0, orders.totalPages - 1)}">
											<li class="page-item" th:classappend="${pageNumber == orders.number ? 'active' : ''}">
												<th:block th:if="${pageNumber == orders.number}">
													<span class="page-link" th:text="${pageNumber + 1}"></span>
												</th:block>
												<th:block th:unless="${pageNumber == orders.number}">
													<a class="page-link" th:inline="text" th:href="@{/viewaccount(page=${pageNumber + 1}, size=${size}, sort=${sortOption}, orderId=${orderId}, accountId=${accountId})}" th:text="${pageNumber + 1}"></a>
												</th:block>
											</li>
										</th:block>

										<li th:if="${orders.hasNext()}" class="page-item">
											<a class="page-link" th:href="@{/viewaccount(page=${orders.number + 2}, size=${size}, sort=${sortOption}, orderId=${orderId}, accountId=${accountId})}">
												<span class="material-symbols-outlined">navigate_next</span>
											</a>
										</li>
									</ul>
								</div>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>

    </div>

	<div th:replace="~{layout/footer :: footer}"></div>
	<script>
		// Đặt thời gian cho alert
        setTimeout(function() {
            document.getElementById('myAlert').style.display = 'none';
        }, 10000);  // Alert sẽ biến mất sau 10 giây
	</script>
	<script>
		window.onload = function() {
		var gender = document.getElementById('gender').value;
		if (gender == 'Nữ') {
			document.getElementById('female-icon').style.display = 'inline';
			document.getElementById('male-icon').style.display = 'none';
		} else if (gender == 'Nam') {
			document.getElementById('female-icon').style.display = 'none';
			document.getElementById('male-icon').style.display = 'inline';
		} else {
			document.getElementById('female-icon').style.display = 'none';
			document.getElementById('male-icon').style.display = 'none';
		}
	};
	</script>

</body>
</html>